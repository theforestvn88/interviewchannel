<%= turbo_frame_tag "mini_calendar" do %>
    <% today_mday = @today.mday %>
    <% this_month = @today == @target_date %>

    <div class="flex justify-start">
        <% if this_month %>
            <span class="text-sm underline mr-1"><%= @today.strftime('%B') %></span>
            <span class="text-sm hover:underline ml-1"><%= button_to @today.next_month.strftime('%B'), mini_calendar_path, method: :get, params: {offset: 1} %></span>
        <% else %>
            <span class="text-sm hover:underline mr-1"><%= button_to @today.strftime('%B'), mini_calendar_path(offset: 0), method: :get %></span>
            <span class="text-sm underline ml-1"><%= @target_date.strftime('%B') %></span>
        <% end %>
    </div>

    <table class="text-xs text-gray-600">
        <tbody>
            <tr>
                <th class="w-7 border-b-2 border-l-2 border-gray-200">Sun</th>
                <th class="w-7 border-b-2 border-l-2 border-gray-200 bg-gray-50">Mon</th>
                <th class="w-7 border-b-2 border-l-2 border-gray-200">Tue</th>
                <th class="w-7 border-b-2 border-l-2 border-gray-200 bg-gray-50">Wed</th>
                <th class="w-7 border-b-2 border-l-2 border-gray-200">Thu</th>
                <th class="w-7 border-b-2 border-l-2 border-gray-200 bg-gray-50">Fri</th>
                <th class="w-7 border-b-2 border-l-2 border-gray-200">Sat</th>
            </tr>
            <% (0..4).each do |week| %>
                <tr class="border-l-2 border-gray-200">
                    <% (0..6).each do |weekday| %>
                        <% if counter = @month_days[index = week*7 + weekday] %>
                            <% mday, date, count = counter %>
                            <td class="w-7 h-7 text-center border-r-2 border-b-2 border-gray-200 <%= count > 0 ? 'hover:cursor-pointer text-gray-600 bg-red-200' : 'text-gray-400' %> <%= index%2==0 ? 'bg-gray-50' : '' %>" title='<%= count > 0 ? "#{count} interviews" : "" %>'>
                                <%= button_to "#{mday}", calendar_path(display: :daily, date: date), class: "w-full h-6 #{this_month && mday == today_mday ? 'h-full border-2 border-gray-400 rounded-full' : ''}" %>
                            </td>
                        <% else %>
                            <td class="w-7 h-7 border-r-2 border-b-2 border-gray-200 <%= index%2==0 ? 'bg-gray-50' : '' %>"></td>
                        <% end %>
                    <% end %>
                </tr>
            <% end %>
        </tbody>
    </table>
<% end %>